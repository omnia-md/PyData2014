% title: Engineering a full python stack for biophysical computation
% author: Kyle A. Beauchamp
% author: Slides here: http://tinyurl.com/n4vq9aj
% favicon: figures/membrane.png

---
title: Moore's Law



<center>
<img height=550 src=figures/moore_law.png />
</center>

<footer class="source"> 
http://en.wikipedia.org/wiki/Moore%27s_law
</footer>

---
title: What about medicine?

<center>
<img height=450 src=figures/drugs.jpg/>
</center>


<footer class="source"> 
http://seniorhousingforum.net/
</footer>

---
title: New Drugs?

<center>
<img height=450 src=figures/new_mol_ent.jpg/>
</center>

<footer class="source"> 
http://www.forbes.com/sites/matthewherper/2011/06/27/the-decline-of-pharmaceutical-researchmeasured-in-new-drugs-and-dollars/
</footer>
---
title: Eroom's Law

<center>
<img height=450 src=figures/eroom.png />
</center>


<footer class="source"> 
Scannell, 2012
</footer>
---
title: How much do drugs cost?  
subtitle: $2,000,000, 15 years, 95% fail rate

<center>
<img height=450 src=figures/cost_structure.jpg />
</center>

<footer class="source"> 
Paul, 2010
</footer>


---
title: Can computers help us design drugs?

Pre-clinic, we've spent five years and over $200,000,000!

<center>
<img height=350 src=figures/cost_structure_small.jpg />
</center>

<footer class="source"> 
Paul, 2010
</footer>

---
title: Can computers help us design drugs?

<center>
<img height=475 src=figures/cruise.png />
</center>

<footer class="source"> 
Figure credit: @jchodera
</footer>

---
title: A brief introduction to biophysics
class: segue dark nobackground


---
title: How do drugs work?
subtitle: Specifically, how do kinase inhibitor chemotherapeutics work?


<center>
<img height=430 src=figures/2HW0-covalent.png />
</center>


<footer class="source"> 
PDB Code: 2HWO.  Figure generated by @sonyahanson
</footer>
---
title: Introduction to Molecular Dynamics

- Simulate the physical interactions of proteins in solution
- Numerically integrate the equations of motion

<center>
<img height=430 src=figures/hp35_box.png />
</center>

---
title: Atomistic Physical Modeling

- Model the physics of atoms and molecules
- Proteins, drugs, water, salt, 

<div>
<video id="sampleMovie" class="center" src="movies/shaw-dasatanib-2.mov" loop=\"true\ autoPlay=\"true\  width="512" height="384"></video>
</div>


---
title: Tools for Atomistic Biophysical Models
class: segue dark nobackground

---
title: OpenMM
subtitle: GPU accelerated molecular dynamics engine

- C++ library with (swig) Python wrapper
- Hardware backends for CUDA, OpenCL, CPU
- Speed, flexibility, extensibility, maintainability

<center>
<img height=300 src=figures/openmm.png />
</center>

<footer class="source"> 
openmm.org
</footer>

---
title: Folding@Home

- Powered by backends including OpenMM and Gromacs
- Largest distributed computing project
- 100,000+ CPUs, 10000+ GPUs, 40 petaflops!

<center>
<img height=300 src=figures/folding-icon.png />
</center>


<footer class="source"> 
http://folding.stanford.edu/
</footer>

---
title: MDTraj
subtitle: Read, write, and analyze trajectories with only a few lines of Python.

- Multitude of formats (PDB, DCD, XTC, HDF, CDF, mol2)
- Numpy / Cython / C / SSE kernels for geometric analysis (distances, angles, RMSD)

<center>
<img height=300 src=figures/mdtraj_logo-small.png/>
</center>

<footer class="source"> 
mdtraj.org
</footer>

---
title: MDTraj
subtitle: Read, write, and analyze trajectories with only a few lines of Python.

<pre class="prettyprint" data-lang="python">

import glob
import mdtraj as md

filenames = glob.glob("./Trajectories/*.h5")
trajectories = [md.load(filename) for filename in filenames]

</pre>

---
title: MSMBuilder / Mixtape (beta)
subtitle: sklearn-compatible machine learning models for conformation dynamics



<center>
<img height=300 src=figures/msmbuilder.png />
</center>


<footer class="source"> 
msmbuilder.org
</footer>


---
title: MSMBuilder / Mixtape (beta)
subtitle: sklearn-compatible machine learning models for conformation dynamics

<pre class="prettyprint" data-lang="python">

import mdtraj as md
import mixtape.featurizer, mixtape.datasets, mixtape.cluster, mixtape.markovstatemodel
import sklearn.pipeline

trajectories = mixtape.datasets.alanine_dipeptide.fetch_alanine_dipeptide()["trajectories"]

cluster = mixtape.cluster.KCenters(n_clusters=10, metric=md.rmsd)
msm = mixtape.markovstatemodel.MarkovStateModel()
pipeline = sklearn.pipeline.Pipeline([("cluster", cluster), ("msm", msm)])

pipeline.fit(trajectories)

</pre>

---
title: Yank (Beta)
subtitle: Run accurate ligand binding simulations



<footer class="source"> 
https://github.com/choderalab/yank
</footer>

---
title: Others

- PDBFixer: Automatic pipeline for preparing protein simulations from crystal structures
- pymbar: Statistical analysis toolkit for binding affinity calculations

<footer class="source"> 
omnia.md
</footer>
---
title: Python Packaging Blues
class: segue dark nobackground

---
title: Packaging scientific software is hard!

- In 2008, I was compiling BLAS / Numpy / Scipy
- 2010: Switched to Enthought python
- 2012: Challenges with mixed language dependencies (FFTW, OpenMM)
- GPUs are flaky
- Non-experts unable to share code

---
title: Conda!

<pre class="prettyprint" data-lang="bash">
conda install -c https://conda.binstar.org/kyleabeauchamp omnia-md
</pre>

---
title: Conda Packaging

- Build all recipes on a Centos 6.5 Vagrant box (https://github.com/omnia-md/virtual-machines/)
- Build


---
title: Automating Biophysics
class: segue dark nobackground

---
title: Made to be broken
subtitle: How can we falsify and refine computer based models?

- Chemistry and biophysics are labor-intensive
- Thousands of parameters = thousands of measurements
- Reproducibilty and scalabity

---
title: Experiments

- Ligand binding (fluorescence)
- Density (of neat liquids and mixtures)
- Isothermal Calorimetry

---
title: Robots!


<center>
<video width="960" height="540" controls>
  <source src="movies/robot.mp4" type="video/mp4">
</video>
</center> 




---
title: People

- John Chodera (MSKCC)
- Patrick Grinaway (MSKCC)
- Vijay Pande (Stanford, Folding@Home)
- Robert McGibbon (Stanford)
- Peter Eastman (Stanford)
- Yutong Zhao (Stanford)
- Joy Ku (Stanford)
- Justin MacCallum (U. Calgary)
- Jason Swails (Rutgers)
